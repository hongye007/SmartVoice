# SmartVoice 功能规格与优先级

**产品:** SmartVoice
**版本:** 1.0 (MVP)
**日期:** 2026-01-20
**状态:** 草稿

---

## 📋 功能概览

SmartVoice 的核心功能围绕"简单输入、智能生成"的理念,让用户轻松创作专业级多角色有声内容。

### 核心价值链

```
文本上传 → 智能识别 → 角色配置 → 音色定制 → 批量生成 → 预览导出
```

---

## 🎯 MVP 功能范围

### MVP 目标

**核心目标:** 验证"智能多角色有声内容生成"的核心价值,快速获取首批用户反馈。

**用户故事:**
> 作为一个小说爱好者/内容创作者,我希望能够上传一部小说文本,系统自动识别角色和对话,为每个角色分配不同的音色,快速生成多角色有声内容,这样我就可以听到生动的有声版作品。

### MVP 包含的功能

**P0 级别 - 必须有 (MVP 核心):**

1. ✅ 文本上传与格式解析
2. ✅ 智能角色识别与自动分配
3. ✅ 音色预览和高级定制
4. ✅ 批量章节生成
5. ✅ 情绪和语调智能理解
6. ✅ 历史记录和角色设置复用
7. ✅ 音频预览和导出

**P1 级别 - 重要但非必须 (MVP 后优先迭代):**

- 背景音效和配乐
- 用户账号系统

**P2 级别 - 锦上添花 (长期迭代):**

- 多种音频格式导出
- 分享功能

---

## 📦 P0 功能详细规格

### 功能 1: 文本上传与格式解析

**功能描述:**
用户可以上传 txt、epub 等格式的文本文件,系统自动解析内容结构,识别章节、段落、对话和旁白。

**用户需求:**
- 支持常见文本格式(txt、epub)
- 自动识别章节结构
- 支持长文本(小说可能数十万字)

**功能细节:**

**输入:**
- 文件上传:支持拖拽或选择文件
- 支持格式:txt(UTF-8编码)、epub
- 文件大小限制:单文件 ≤ 10MB(约500万字)

**处理逻辑:**
1. 文件格式检测和验证
2. 文本内容提取
3. 章节结构识别(基于标题、空行、章节标记等)
4. 段落分割
5. 初步对话识别(引号、冒号等标记)

**输出:**
- 结构化的文本内容
- 章节列表(章节名、字数)
- 对话段落标记

**非功能需求:**
- 上传速度: < 5秒(1MB文件)
- 解析准确率: 章节识别 > 90%

**技术考虑:**
- epub 解析使用成熟库(如 ebooklib)
- 大文件分块上传和处理
- 前端预览文本结构

---

### 功能 2: 智能角色识别与自动分配

**功能描述:**
系统使用 AI 技术自动识别文本中的角色、对话和旁白,并为每个角色自动分配合适的音色。

**用户需求:**
- 无需手动标注角色和对话
- 准确识别多个角色(支持 10+ 个角色)
- 自动分配音色,区分度高

**功能细节:**

**输入:**
- 解析后的文本内容

**处理逻辑:**
1. **角色识别**
   - 基于对话标记(引号、冒号、"XX说"等)
   - 使用 NLP 模型识别说话者
   - 角色实体识别和聚类

2. **对话归属**
   - 将对话内容关联到对应角色
   - 识别旁白(非对话内容)

3. **角色分类**
   - 角色性别推断(基于名字、称谓、对话内容)
   - 角色重要性判断(出场频率、对话量)

4. **音色自动分配**
   - 主要角色:分配特色鲜明的音色
   - 次要角色:分配区分度高的音色
   - 旁白:分配专门的叙述音色
   - 性别匹配:男性角色 → 男声,女性角色 → 女声

**输出:**
- 角色列表(角色名、性别、重要性、对话数量)
- 每个角色的默认音色分配
- 角色-对话映射关系
- 旁白标记

**非功能需求:**
- 识别准确率: > 85%
- 处理速度: < 30秒(10万字文本)
- 支持角色数量: 无限制(实际测试支持 20+ 个)

**用户可调整:**
- 角色名称修改
- 角色合并/拆分
- 对话归属调整
- 音色重新分配

**技术考虑:**
- 使用 NLP 模型(如 BERT、GPT)进行角色识别
- 对话归属使用规则+模型结合
- 音色库需要足够丰富(初期至少 20+ 种音色)

---

### 功能 3: 音色预览和高级定制

**功能描述:**
用户可以预览每个角色的音色效果,并进行高级定制,包括音色选择、音速、语调、情绪等参数调整。

**用户需求:**
- 快速预览音色效果
- 精细调整音色参数
- 确保音色符合角色设定

**功能细节:**

**音色库:**
- 初期提供 20+ 种基础音色
  - 男声: 8-10 种(青年、中年、老年、磁性、清亮等)
  - 女声: 8-10 种(少女、御姐、温柔、活泼等)
  - 中性/特殊: 2-4 种(童声、机器人等)
  - 旁白: 2-3 种(专业叙述音色)

**可调整参数:**

1. **基础参数**
   - 音色选择:从音色库中选择
   - 音速:0.5x - 2.0x (默认 1.0x)
   - 音调:降低/正常/升高 (-3 到 +3)
   - 音量:50% - 150% (默认 100%)

2. **高级参数**
   - 语调(tone):平稳/抑扬顿挫
   - 情绪基调:中性/开朗/严肃/忧郁/愤怒等
   - 停顿时长:短/中/长

**预览功能:**
- 选择一段对话进行试听(约 50-100 字)
- 实时调整参数,快速重新生成
- 支持 A/B 对比(对比不同音色或参数)

**交互流程:**
```
查看角色列表 → 选择角色 → 查看默认音色 → 点击预览 →
→ 试听效果 → 调整参数 → 再次预览 → 满意后保存
```

**输出:**
- 每个角色的音色配置
  - 音色 ID
  - 音速、音调、音量
  - 语调和情绪设置

**非功能需求:**
- 预览生成速度: < 3 秒(100字文本)
- 参数调整实时响应
- 音色质量:接近真人,自然流畅

**技术考虑:**
- TTS 引擎选择:优先使用头部厂商 API(讯飞、百度、阿里)
- 音色库需要预先测试和分类
- 缓存常用音色样本,加速预览

---

### 功能 4: 批量章节生成

**功能描述:**
用户确认角色配置后,可以批量生成多个章节的有声内容,系统保持角色音色一致性。

**用户需求:**
- 一次生成多个章节,避免重复操作
- 角色音色在所有章节保持一致
- 生成进度可视化

**功能细节:**

**生成模式:**

1. **单章节生成**(用于预览和测试)
   - 选择任意章节
   - 快速生成,用于验证效果

2. **批量生成**(用于正式制作)
   - 选择多个章节(支持全选)
   - 按顺序生成
   - 自动命名(章节名)

**处理逻辑:**
1. 读取角色配置(音色、参数)
2. 按章节顺序处理
   - 逐段落调用 TTS API
   - 根据角色ID应用对应音色
   - 根据标点和语境调整停顿
3. 音频拼接(按段落顺序)
4. 生成完整章节音频文件

**进度显示:**
- 当前处理章节
- 当前章节进度(百分比)
- 预计剩余时间
- 已完成章节列表

**输出:**
- 每个章节一个音频文件
  - 文件名:章节名.mp3
  - 时长:自动计算
  - 元数据:标题、作者(如有)

**非功能需求:**
- 生成速度:约 1 分钟/万字(取决于 TTS API)
- 角色音色一致性: 100%
- 支持断点续传(生成中断可继续)

**技术考虑:**
- 异步任务处理,避免长时间阻塞
- 使用队列管理批量任务
- 音频拼接使用 ffmpeg 或类似工具
- 进度通过 WebSocket 实时推送

---

### 功能 5: 情绪和语调智能理解

**功能描述:**
系统根据文本内容和语境,自动理解和表达情绪(喜悦、悲伤、愤怒等)和语调(疑问、感叹、陈述等)。

**用户需求:**
- 对话表达有情感,不是机器人朗读
- 语调符合句子类型(疑问句上扬、感叹句加强等)
- 无需手动标注情绪

**功能细节:**

**情绪识别:**

1. **基于文本内容**
   - 关键词识别(高兴、难过、愤怒、惊讶等情绪词)
   - 语气词识别(啊、哇、唉、哼等)
   - 标点符号(!!、??、...)

2. **基于语境理解**
   - 上下文情感分析
   - 剧情发展趋势(冲突、和解、高潮等)
   - 角色关系(亲密、敌对、陌生等)

**支持的情绪类型:**
- 中性(默认)
- 开心/喜悦
- 悲伤/忧郁
- 愤怒/生气
- 惊讶/惊恐
- 温柔/亲切
- 严肃/认真

**语调控制:**
- 陈述句:平稳语调
- 疑问句:句尾上扬
- 感叹句:加强情感
- 命令句:语气坚定

**实现方式:**
- 情绪标签:为每段对话自动打情绪标签
- TTS 参数映射:情绪 → 音色参数调整
- 用户可覆盖:手动修改情绪标签(高级功能)

**输出:**
- 带情绪标签的文本
- 调整后的 TTS 参数

**非功能需求:**
- 情绪识别准确率: > 70%
- 处理不增加明显延迟

**技术考虑:**
- 使用情感分析模型(如 BERT-based sentiment analysis)
- TTS API 需要支持情绪参数(部分厂商支持)
- 如 TTS 不支持,通过音速、音调模拟情绪

---

### 功能 6: 历史记录和角色设置复用

**功能描述:**
系统保存用户的历史项目和角色配置,同一作品的后续章节可以直接复用之前的设置。

**用户需求:**
- 避免重复配置角色
- 保持多次生成的一致性
- 方便管理多个项目

**功能细节:**

**项目管理:**
- 每次上传文本创建一个"项目"
  - 项目名称(默认为文件名,可修改)
  - 创建时间
  - 文本内容
  - 角色配置
  - 生成历史

**历史记录包含:**
1. **项目信息**
   - 项目名称
   - 文本来源(文件名)
   - 创建和更新时间
   - 章节列表

2. **角色配置**
   - 所有角色的音色设置
   - 角色名称和性别
   - 自定义参数

3. **生成历史**
   - 已生成的章节列表
   - 生成时间
   - 音频文件链接(7天有效)

**复用功能:**
- **继续生成**:为同一项目生成新章节
  - 自动加载之前的角色配置
  - 保持音色一致性

- **复制配置**:将某个项目的角色配置应用到新项目
  - 适用于同一作者的不同作品

**数据存储:**
- 本地存储(LocalStorage):项目列表、基本信息
- 云端存储(MVP 后):完整配置和音频文件

**交互流程:**
```
首页查看项目列表 → 点击项目 → 查看历史配置 →
→ 上传新章节 → 自动加载配置 → 直接生成
```

**非功能需求:**
- 项目数量限制:免费用户 5 个,付费用户无限
- 配置加载: < 1 秒
- 数据保留:本地永久,云端根据会员等级

**技术考虑:**
- MVP 阶段使用浏览器 LocalStorage
- 后续引入用户账号系统后迁移到云端
- 数据结构设计考虑扩展性

---

### 功能 7: 音频预览和导出

**功能描述:**
用户可以在线预览生成的音频,并下载为音频文件。

**用户需求:**
- 在线试听效果
- 下载到本地
- 音质清晰

**功能细节:**

**预览功能:**
- 在线播放器
  - 播放/暂停
  - 进度条拖动
  - 音量调节
  - 播放速度调节(0.5x - 2.0x)
- 章节列表播放
  - 选择任意章节播放
  - 连续播放(自动播放下一章节)

**导出功能:**
- 单章节导出
  - 点击下载按钮
  - 文件名:项目名-章节名.mp3

- 批量导出(P1功能)
  - 打包所有章节为 ZIP
  - 文件名:项目名-全集.zip

**音频格式:**
- MVP 阶段:仅支持 MP3(主流格式,兼容性好)
  - 采样率:24kHz 或 44.1kHz
  - 比特率:64kbps - 128kbps(平衡质量和大小)

**非功能需求:**
- 在线播放流畅,无卡顿
- 下载速度:取决于文件大小和网络
- 音质:接近原始 TTS 输出质量

**技术考虑:**
- 音频存储:云存储(OSS、S3)
- 音频流式传输:HLS 或直接 HTTP
- 下载链接有效期:7 天(节省存储成本)

---

## 📦 P1 功能 (MVP 后优先迭代)

### 功能 8: 背景音效和配乐

**功能描述:**
为有声内容添加背景音乐和音效,提升氛围感和沉浸感。

**用户需求:**
- 为不同场景添加合适的背景音乐(如悬疑、温馨、激烈)
- 添加音效(如脚步声、关门声、雨声等)

**实现方式:**
- 提供音效库
- 用户手动或自动标注场景
- 音频混音

**优先级:** P1(重要但非 MVP 必须,增加制作复杂度)

---

### 功能 9: 用户账号系统

**功能描述:**
用户可以注册账号,登录后同步项目和配置,支持多设备访问。

**用户需求:**
- 数据云端保存,不丢失
- 多设备访问
- 付费订阅管理

**实现方式:**
- 用户注册/登录(手机号、邮箱、第三方登录)
- 云端数据存储
- 会员体系

**优先级:** P1(商业化必需,但 MVP 可先使用本地存储)

---

## 📦 P2 功能 (长期迭代)

### 功能 10: 多种音频格式导出

**功能描述:**
支持导出 MP3、WAV、M4A、FLAC 等多种音频格式。

**优先级:** P2(MP3 已满足绝大部分需求)

---

### 功能 11: 分享功能

**功能描述:**
用户可以将生成的有声内容分享给朋友或发布到社交平台。

**优先级:** P2(MVP 聚焦创作,分享可后续增加)

---

## 🎯 功能优先级矩阵

| 功能 | 优先级 | 用户价值 | 技术复杂度 | MVP 包含 |
|------|--------|---------|-----------|---------|
| 文本上传与解析 | P0 | 高 | 中 | ✅ |
| 智能角色识别 | P0 | 极高 | 高 | ✅ |
| 音色预览和定制 | P0 | 极高 | 中 | ✅ |
| 批量章节生成 | P0 | 高 | 中 | ✅ |
| 情绪语调理解 | P0 | 高 | 高 | ✅ |
| 历史记录复用 | P0 | 高 | 低 | ✅ |
| 音频预览导出 | P0 | 极高 | 低 | ✅ |
| 背景音效配乐 | P1 | 中 | 中 | ❌ |
| 用户账号系统 | P1 | 高 | 中 | ❌ |
| 多格式导出 | P2 | 低 | 低 | ❌ |
| 分享功能 | P2 | 中 | 中 | ❌ |

---

## 🔧 技术架构考虑

### TTS 引擎选择

**方案对比:**

| 方案 | 优点 | 缺点 | 推荐度 |
|------|------|------|--------|
| **讯飞语音** | 音色丰富,质量好,中文优化 | 价格较高 | ⭐⭐⭐⭐⭐ |
| **百度语音** | 性价比高,稳定 | 音色略少 | ⭐⭐⭐⭐ |
| **阿里云语音** | 价格低,集成方便 | 音色质量一般 | ⭐⭐⭐ |
| **自研模型** | 完全自主,成本低 | 开发周期长,质量不确定 | ⭐⭐ |

**推荐方案:**
- **MVP 阶段**:使用讯飞或百度 API,快速验证产品
- **成长期**:根据成本和质量需求,考虑自研或混合方案

### 性能指标

**处理速度要求:**
- 10万字文本:角色识别 < 30秒,音频生成 < 10分钟
- 单章节(5000字):< 3分钟
- 音色预览(100字):< 3秒

**音色库规模:**
- MVP: 20+ 种基础音色
- 成长期: 50+ 种音色,支持自定义训练

**成本控制:**
- TTS API 成本:约 ¥0.1-0.3/千字
- 单用户月均成本:¥5-20(取决于使用量)
- 免费额度:1-5万字/月

---

## ✅ 验收标准

### MVP 成功标准

**功能完整性:**
- ✅ 用户可以上传 txt/epub 文件
- ✅ 系统自动识别至少 80% 的角色和对话
- ✅ 用户可以预览和调整音色
- ✅ 用户可以批量生成多个章节
- ✅ 生成的音频有明显的情绪和语调变化
- ✅ 用户可以复用历史配置
- ✅ 用户可以在线预览和下载音频

**用户体验:**
- 首次使用< 5分钟完成一章生成
- 界面简洁直观,无需查看文档
- 操作流畅,无明显卡顿

**技术指标:**
- 角色识别准确率 > 85%
- 音频质量接近真人(用户盲测满意度 > 70%)
- 系统可用性 > 99%

---

## 🔗 相关文档

- [产品简介](../SmartVoice-brief.md)
- [用户画像](../personas/)
- [市场分析](../competitive-analysis/)
- [产品路线图](../roadmap/)

---

## 📝 更新历史

| 版本 | 日期 | 变更说明 | 作者 |
|------|------|----------|------|
| 1.0  | 2026-01-20 | 初始版本,定义 MVP 功能范围 | SmartVoice 团队 |

---

**注:** 功能规格应根据技术验证和用户反馈持续迭代优化。
