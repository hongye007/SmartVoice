---
name: tech-design
description: 技术架构设计技能,基于产品规划文档生成完整的技术架构设计方案。使用场景:(1) 产品规划完成后,需要进行技术选型和架构设计;(2) 评估技术可行性和成本;(3) 制定技术实施路线图;(4) 为开发团队提供技术指导文档。输入产品规划(PRD/产品简介/功能规格),输出技术选型对比、系统架构设计、API 设计、成本估算、技术路线图等完整技术文档。不适用于:具体代码实现、运维部署细节、已有系统的重构设计。
---

# 技术架构设计技能

基于产品规划文档,生成完整的技术架构设计方案,包括技术选型、系统架构、API 设计、成本估算等。

## 使用流程

### 启动技能

当用户完成产品规划,需要进行技术设计时:

1. **读取产品规划文档** - 理解产品功能、用户需求、非功能需求
2. **确认技术约束** - 询问团队技术栈偏好、预算限制、时间要求
3. **开始技术设计** - 按照 6 个模块逐步生成技术文档

### 六大技术设计模块

---

#### 🎯 模块 0: 技术总体设计 (新增)

**目标:** 从产品需求到技术实现的整体规划,建立技术全局视角

**设计内容:**

1. **产品核心流程梳理**
   - 识别产品的核心业务流程(2-5个关键流程)
   - 从用户视角描述端到端的业务流
   - 标注每个流程的关键节点

2. **技术实现映射**
   - 将业务流程映射到技术实现
   - 识别每个环节需要的技术能力
   - 绘制技术全链路流程图

3. **关键技术挑战识别**
   - 列出 3-5 个最核心的技术挑战
   - 评估技术难度和风险
   - 提出初步解决思路

4. **技术边界和约束**
   - 团队技术能力边界
   - 预算和时间约束
   - 性能和规模要求
   - 合规和安全要求

5. **技术分层策略**
   - 确定系统的大层级划分(如前端层、API层、业务层、数据层)
   - 明确各层职责
   - 定义层间交互方式

**关键问题:**

1. **核心业务流程**
   - "产品最核心的 3-5 个业务流程是什么?"
   - "每个流程的关键步骤有哪些?"
   - 从产品功能规格自动提取

2. **技术挑战**
   - "哪些功能在技术实现上最具挑战性?"
   - "预期的性能瓶颈在哪里?"
   - "需要特殊处理的技术点有哪些?"

3. **约束条件**
   - "团队规模和技术能力如何?"
   - "开发周期有多长?"
   - "预算范围是多少?"
   - "有哪些必须满足的非功能需求?"

**输出文档:**
- `docs/02-technical-design/[产品名]/overall-design.md` - 使用 `templates/overall-design.md` 模板
- 包含:
  - 核心业务流程图
  - 技术实现全链路图
  - 关键技术挑战清单
  - 技术边界和约束说明
  - 技术分层架构草图

**示例(SmartVoice):**

**核心流程:**
```
流程1: 文本上传到角色识别
用户上传文件 → 文本解析 → 章节识别 → 角色识别 → 对话归属 → 音色分配

技术映射:
- 文件上传 → OSS存储 + 后端验证
- 文本解析 → 自研解析器(txt/epub)
- 角色识别 → NLP模型(BERT/GPT API)
- 数据存储 → PostgreSQL

关键挑战:
1. 角色识别准确率(目标>85%)
2. 长文本处理性能(10万字<30秒)
```

---

#### 📦 模块 1: 技术栈选型

**目标:** 为项目选择合适的技术栈

**输入信息:**
- 产品功能需求(从 PRD 获取)
- 团队技术能力
- 性能要求
- 预算约束

**关键问题:**

1. **前端技术栈**
   - "团队更熟悉哪个前端框架?(React/Vue/Angular/其他)"
   - "是否需要 SSR(服务端渲染)?是否需要 SEO?"
   - "移动端适配策略是什么?(响应式/PWA/原生 App?)"

2. **后端技术栈**
   - "团队更熟悉哪门后端语言?(Node.js/Python/Java/Go/其他)"
   - "预期的并发量级是多少?"
   - "是否有特定的性能要求?"

3. **数据库选择**
   - "数据结构复杂度如何?(关系型/NoSQL/混合)"
   - "数据一致性要求高吗?"
   - "预期数据量级?"

**输出文档:**
- `docs/02-technical-design/[产品名]/tech-stack.md` - 使用 `templates/tech-stack.md` 模板
- 包含:前端/后端/数据库选型对比表、推荐方案、理由

**参考资料(按需):**
- 如需技术选型方法论,读取 `references/tech-selection-framework.md`

---

#### 🔌 模块 2: 第三方服务评估

**目标:** 评估和选择关键的第三方服务

**关键问题:**

1. **识别第三方服务需求**
   - "产品依赖哪些第三方服务?(支付/短信/云存储/AI API 等)"
   - 从产品功能中自动识别(如文本转语音需要 TTS API)

2. **服务商对比**
   - 针对每个服务类型,对比主流服务商
   - 维度:功能、价格、质量、稳定性、文档、支持

3. **成本估算**
   - "预期用户规模和使用频率?"
   - 计算各服务商的成本

**输出文档:**
- `docs/02-technical-design/[产品名]/third-party-services.md` - 使用 `templates/third-party-eval.md` 模板
- 包含:服务商对比矩阵、成本估算、推荐方案

**示例(针对 SmartVoice):**
- TTS 服务:讯飞 vs 百度 vs 阿里
- NLP 服务:OpenAI vs 自建模型
- 云服务:阿里云 vs 腾讯云 vs AWS

---

#### 🏗️ 模块 3: 系统架构设计

**目标:** 设计系统整体架构和核心模块

**设计内容:**

1. **整体架构**
   - 架构风格(单体/微服务/Serverless?)
   - 系统分层(前端/BFF/后端/数据层)
   - 架构图(使用 Mermaid 绘制)

2. **核心模块划分**
   - 识别核心业务模块(从功能规格提取)
   - 模块职责定义
   - 模块间依赖关系

3. **数据流设计**
   - 关键业务流程的数据流
   - 异步处理方案(队列、事件驱动)

4. **非功能设计**
   - 性能优化策略
   - 安全设计
   - 可扩展性考虑

**输出文档:**
- `docs/02-technical-design/[产品名]/system-architecture.md` - 使用 `templates/architecture.md` 模板
- 包含:架构图、模块说明、数据流图、技术决策理由

**参考资料(按需):**
- 架构模式参考 `references/architecture-patterns.md`

---

#### 📡 模块 4: API 和数据库设计

**目标:** 设计 API 接口和数据库模型

**设计内容:**

1. **API 设计**
   - RESTful API 设计(或 GraphQL)
   - 核心接口列表
   - 请求/响应示例
   - 错误处理规范

2. **数据库设计**
   - 核心数据模型(ER 图)
   - 表结构设计
   - 索引策略
   - 数据迁移考虑

3. **数据安全**
   - 敏感数据保护
   - 备份策略

**输出文档:**
- `docs/02-technical-design/[产品名]/api-design.md` - API 设计文档
- `docs/02-technical-design/[产品名]/database-design.md` - 数据库设计文档

---

#### 🗺️ 模块 5: 技术实施路线图

**目标:** 制定技术实施计划和里程碑

**内容:**

1. **技术债务评估**
   - MVP 阶段的技术简化
   - 后续需要重构的部分

2. **技术里程碑**
   - 对应产品路线图的技术任务
   - 技术预研和 POC 计划
   - 性能优化计划

3. **开发规范**
   - 代码规范
   - Git 工作流
   - CI/CD 流程
   - 测试策略

4. **风险识别**
   - 技术风险点
   - 应对预案

**输出文档:**
- `docs/02-technical-design/[产品名]/implementation-roadmap.md` - 使用 `templates/tech-roadmap.md` 模板
- 包含:技术里程碑、开发规范、风险清单

---

### 🎯 综合输出

**最终生成:**
- `docs/02-technical-design/[产品名]/technical-design.md` - 主技术设计文档,整合以上所有模块

**文档结构:**
```markdown
# [产品名] 技术架构设计文档

## 0. 技术总体设计
## 1. 技术栈选型
## 2. 第三方服务评估
## 3. 系统架构设计
## 4. API 和数据库设计
## 5. 技术实施路线图
## 附录
```

---

## 输出文档目录结构

```
docs/02-technical-design/[产品名]/
├── technical-design.md (主文档)
├── overall-design.md (技术总体设计)
├── tech-stack.md (技术栈选型)
├── third-party-services.md (第三方服务评估)
├── system-architecture.md (系统架构)
├── api-design.md (API 设计)
├── database-design.md (数据库设计)
└── implementation-roadmap.md (技术路线图)
```

---

## 使用原则

### 输入依赖

技能需要读取以下产品规划文档:
1. 产品简介或 PRD - 理解产品功能
2. 功能规格 - 理解技术需求和非功能需求
3. 产品路线图 - 对应技术里程碑

### 设计原则

1. **MVP 优先** - Alpha/Beta 阶段的技术选型考虑快速验证
2. **成本意识** - 评估第三方服务成本,给出性价比建议
3. **可扩展性** - 考虑后续迭代的扩展需求
4. **团队能力匹配** - 技术选型匹配团队现有能力
5. **技术债务管理** - 明确哪些是临时方案,何时重构

### 交互方式

1. **读取产品规划** - 自动读取 `docs/product/` 下的文档
2. **询问技术约束** - 通过问题了解团队情况和限制
3. **对比和推荐** - 给出多个方案对比,推荐最优方案
4. **生成文档** - 按模块逐步生成,每个模块完成后确认

---

## 配置选项

从 `.claude/preferences.json` 读取:

```json
{
  "preferences": {
    "techDesign": {
      "outputPath": "docs/technical",
      "teamTechStack": {
        "frontend": "React",
        "backend": "Node.js",
        "database": "PostgreSQL"
      },
      "budgetConstraint": "startup",
      "performanceLevel": "medium"
    }
  }
}
```

- `outputPath` - 技术文档输出路径
- `teamTechStack` - 团队已有技术栈(作为参考)
- `budgetConstraint` - 预算约束(startup/enterprise)
- `performanceLevel` - 性能要求(low/medium/high)

---

## 模板文件索引

- `templates/overall-design.md` - 技术总体设计模板
- `templates/tech-stack.md` - 技术栈选型模板
- `templates/third-party-eval.md` - 第三方服务评估模板
- `templates/system-architecture.md` - 系统架构模板
- `templates/api-design.md` - API 设计模板
- `templates/database-design.md` - 数据库设计模板
- `templates/tech-roadmap.md` - 技术路线图模板

---

## 参考资料索引

- `references/tech-selection-framework.md` - 技术选型方法论
- `references/architecture-patterns.md` - 常用架构模式
- `references/cost-estimation.md` - 成本估算方法

---

## 示例使用场景

### 场景 1: 全新 Web 应用

**用户:** 我完成了产品规划,现在需要做技术设计。

**Claude:**
1. 读取产品规划文档
2. 询问技术约束(团队技术栈、预算、时间)
3. 生成技术栈选型对比
4. 评估需要的第三方服务
5. 设计系统架构
6. 生成 API 和数据库设计
7. 制定技术路线图

### 场景 2: AI 应用技术设计

**用户:** 产品需要用到 AI 能力,帮我评估技术方案。

**Claude:**
1. 识别 AI 能力需求(NLP/TTS/图像识别等)
2. 对比自建模型 vs API 服务
3. 评估成本和性能
4. 给出推荐方案

---

## 最佳实践

### 对于用户

1. **提供完整的产品规划** - 技能需要理解产品功能才能设计
2. **明确约束条件** - 团队能力、预算、时间等
3. **参与技术决策** - 对技术方案提供反馈
4. **迭代优化** - 技术设计可随开发进展调整

### 对于 Claude

1. **深入理解产品** - 仔细阅读产品规划文档
2. **对比多方案** - 给出至少 2-3 个技术方案对比
3. **提供理由** - 推荐方案时说明原因
4. **考虑权衡** - 成本 vs 质量,短期 vs 长期
5. **图文并茂** - 使用架构图、流程图增强可读性

---

## 技能元数据

- **版本:** 1.0.0
- **创建日期:** 2026-01-20
- **适用场景:** 产品规划后的技术设计阶段
- **依赖工具:** Read, Write, Bash, WebSearch(可选)

---

**准备好开始技术设计了吗?输入 `/tech-design` 或告诉我"开始技术设计"来启动技术架构设计流程!**
